#!/usr/bin/env bash


GD_DIR=~/GoogleDrive

set -u
#set -x
UMOUNT_MODE=${1:-0}

INSTALL=${2:-0}
if [ "$INSTALL" = 1 ]; then
    sudo add-apt-repository ppa:alessandro-strada/ppa
    sudo apt-get update
    sudo apt-get install google-drive-ocamlfuse
fi

if [ ! -d "$GD_DIR" ]; then 
    mkdir "$GD_DIR"
fi

if [ "$UMOUNT_MODE" = '1' ]; then
    cd ~
    fusermount -u "$GD_DIR"
    rmdir "$GD_DIR"
else
    google-drive-ocamlfuse "$GD_DIR"
    echo
    cmd="ls -la $GD_DIR"
    echo
    eval "$cmd"
    echo -e "\n cd $GD_DIR;\n"
fi


exit 0

##############################################################################

#https://linuxconfig.org/google-drive-on-ubuntu-18-04-bionic-beaver-linux
#https://maddot.ru/google-drive-v-ubuntu-cherez-google-drive-ocamlfuse.html
#Google Drive –≤ Ubuntu —á–µ—Ä–µ–∑ google-drive-ocamlfuse
#29.03.2018
#–í –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π –¥–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è –Ω–µ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å—Ç–æ–ª—å —Å–ª–æ–∂–Ω–æ–π —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ò —ç—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –ø–ª–æ—Ö–æ, –≤–µ–¥—å —Ç–µ–ø–µ—Ä—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å –î–∏—Å–∫ Google –≤ Ubuntu Linux —Å–º–æ–∂–µ—Ç –¥–∞–∂–µ –Ω–æ–≤–∏—á–µ–∫.
#–ù–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –ø—Ä–æ–≥—Ä–∞–º–º—É ‚Äî google-drive-ocamlfuse –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–µ –≤ –æ–¥–∏–Ω (–Ω—É, –º–æ–∂–µ—Ç, –ø–∞—Ä—É) –∫–ª–∏–∫.
#–í—ã–ø–æ–ª–Ω–∏–º –ø–∞—Ä—É –∫–æ–º–º–∞–Ω–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
#–ü–æ–¥–∫–ª—é—á–∏–º —Ä–µ–ø–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —É—Å—Ç–∞–Ω–æ–≤–∏–º –µ–µ:

sudo add-apt-repository ppa:alessandro-strada/ppa
sudo apt-get update
sudo apt-get install google-drive-ocamlfuse

#–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥ Google –¥–∏—Å–∫–∞ –≤ –ª—é–±–æ–π –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥. –°–æ–∑–¥–∞–¥–∏–º –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –Ω–æ–≤—ã–π (–≤ –¥–æ–º–∞—à–Ω–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ) –∏ —Å–º–æ–Ω—Ç–∏—Ä—É–µ–º –æ–±–ª–∞–∫–æ –≤ –Ω–µ–≥–æ:

mkdir ~/GoogleCloud
google-drive-ocamlfuse ~/GoogleCloud

#–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä, –≥–¥–µ —Ç–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è (–µ—Å–ª–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ Google) –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø—Ä–æ–≥—Ä–∞–º–º–µ –∫ —Å–≤–æ–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É.
#–í–æ—Ç –∏ –≤—Å–µ ‚Äî –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ, –ø—Ä–∞–≤–¥–∞? üôÇ

#–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç (–≤ –¥—Ä—É–≥–æ–π –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–æ—Ç–≤.) –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–º–∞–Ω–¥—É:

google-drive-ocamlfuse -label [–ò–ú–Ø] [~/—Ç–æ—á–∫–∞_–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è]

#–ß—Ç–æ–±—ã —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å ¬´–æ–±–ª–∞—á–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥¬ª –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–º–∞–Ω–¥—É:

fusermount -u ~/GoogleCloud

